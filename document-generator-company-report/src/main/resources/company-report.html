<!DOCTYPE html>
<html lang="en">
{{$companyRegistrationInformation := .company_report.company_registration_information}}
{{$previousNames := .company_report.previous_names}}
{{$keyFilingDates := .company_report.key_filing_dates}}
{{$foreignCompanyDetails := .company_report.foreign_company_details}}
{{$foreignCompanyAccounts := .company_report.foreign_company_details.accounts}}
{{$officers := .company_report.current_appointments}}
{{$recentFilingHistory := .company_report.recent_filing_history}}
{{$pscs := .company_report.pscs}}
<<<<<<< HEAD
{{$ukEstablishment := .company_report.uk_establishment}}
=======
{{$pscStatements := .company_report.psc_statements}}
>>>>>>> feature/uk-establishments-mapper

<head>
    <meta charset="UTF-8">
    <title>{{$companyRegistrationInformation.company_name}}</title>
    <style type="text/css">

      main {
        padding-bottom: 3em;
      }

      .pagebreak {
        page-break-before: always;
      }

      .foreign-company-details-table {
        margin-bottom: 1em;
      }

      @media print {

        .page-break {
          min-height: 400px;
          page-break-before: always;
        }
        .page {
          min-height: 25cm;
          border-style: solid;
          border-width: 0;
          page-break-after: always;
          margin: 0 auto;
          width: 170mm;
          position: relative;
        }
        @page {
          size: A4;
        }
        @media print {
          body,
          html {
            height: 257mm;
            margin: 0 auto;
            width: 170mm;
            font-size: 12px;
          }
        }
        @media screen {
          .page {
            margin-bottom: 5em;
          }
        }
        .section-marker {
          left: 0;
          position: absolute;
          top: 0;

          * {
            position: relative;
          }
        }
    </style>
    <link href="https://d11ystzvnk2sve.cloudfront.net/stylesheets/assets-digital-cabinet-office-gov-uk-static/govuk-template.css" media="screen" rel="stylesheet" type="text/css">
    <link href="https://d11ystzvnk2sve.cloudfront.net/stylesheets/application.css" media="screen" rel="stylesheet" type="text/css">
</head>
<body id="page-container">

<header role="banner">
    <a href="https://beta.companieshouse.gov.uk/company/00006400">
        <span class="visually-hidden">{{$companyRegistrationInformation.company_name}}</span><img src="https://document-render-assets-registry.s3-eu-west-1.amazonaws.com/accounts/images/ch-logo.png" alt=""></a>

    <h1 class="heading-xlarge">{{$companyRegistrationInformation.company_name}}<br/>
        {{$companyRegistrationInformation.company_number}}</h1>
    <p class="heading-small">Created: {{.company_report.time_stamp_created}}</p>
    <p class="heading-small">Companies House does not verify the accuracy of the information filed</p>
</header>
<main role="main">

    <h2 class="heading-large">Overview</h2>
    <ul class="list list-bullet">
        {{if $roa := $companyRegistrationInformation.registered_office}}
        <li>

            {{if eq $companyRegistrationInformation.company_type.type "UK establishment company"}}
                UK establishment office address:

            {{else if eq $companyRegistrationInformation.company_type.type "Overseas company"}}
                Overseas company address:

            {{else if eq $companyRegistrationInformation.company_type.type "Scottish qualifying partnership"}}
                Service address:

            {{else}}
                Registered office address:
            {{end}}

            {{if $roa.care_of}}
            {{index $roa "care_of"}},
            {{end}}
            {{if $roa.po_box}}
            {{index $roa "po_box"}},
            {{end}}
            {{if $roa.premises}}
            {{index $roa "premises"}},
            {{end}}
            {{if $roa.address_line_1}}
            {{index $roa "address_line_1"}},
            {{end}}
            {{if $roa.address_line_2}}
            {{index $roa "address_line_2"}},
            {{end}}
            {{if $roa.locality}}
            {{index $roa "locality"}},
            {{end}}
            {{if $roa.region}}
            {{index $roa "region"}},
            {{end}}
            {{if $roa.country}}
            {{index $roa "country"}},
            {{end}}
            {{if $roa.postal_code}}
            {{index $roa "postal_code"}}
            {{end}}
        </li>
        {{end}}

        {{if $companyRegistrationInformation.company_type.type}}
            <li>Company type: {{$companyRegistrationInformation.company_type.type}}
                {{if $companyRegistrationInformation.company_type.subtype}}/{{$companyRegistrationInformation.company_type.subtype}}{{end}}</li>
        {{end}}

        {{if ne $companyRegistrationInformation.company_type.type "Overseas company"}}
            {{if $companyRegistrationInformation.external_registration_number}}
                <li>Charity number: {{$companyRegistrationInformation.external_registration_number}}</li>
            {{end}}
        {{end}}

        {{if $companyRegistrationInformation.date_of_incorporation}}
            <li>{{$companyRegistrationInformation.date_of_incorporation_label}}: {{$companyRegistrationInformation.date_of_incorporation}}</li>
        {{end}}

        {{if $companyRegistrationInformation.status.company_status}}
            <li>Status: {{$companyRegistrationInformation.status.company_status}}
                {{if $companyRegistrationInformation.status.company_status_detail}}/{{$companyRegistrationInformation.status.company_status_detail}}{{end}}</li>
        {{end}}

    </ul>
    
    {{if $foreignCompanyDetails}}

        {{if (eq $foreignCompanyDetails.is_a_credit_financial_institution true)}}
            This company is a credit/financial institution
        {{end}}

        {{if and $foreignCompanyDetails.accounting_requirements.foreign_account_type $foreignCompanyDetails.accounting_requirements.terms_of_account_publication}}

            {{if eq $foreignCompanyDetails.accounting_requirements.foreign_account_type "accounting-requirements-of-originating-country-apply"}}

                {{if eq $foreignCompanyDetails.accounting_requirements.terms_of_account_publication "accounting-publication-date-does-not-need-to-be-supplied-by-company"}}

                    {{if $keyFilingDates.last_accounts_made_up_to}}
                        <h3 class="heading-small">Accounts</h3>
                        Last accounts made up to: {{$keyFilingDates.last_accounts_made_up_to}}
                    {{end}}

                {{end}}

                {{if eq $foreignCompanyDetails.accounting_requirements.terms_of_account_publication "accounts-publication-date-supplied-by-company"}}

                    <h3 class="heading-small">Accounts</h3>
                    {{if $foreignCompanyDetails.accounts}}
                        <p>Required to publish accounts from {{$foreignCompanyDetails.accounts.account_period_from.day}}
                            {{$foreignCompanyDetails.accounts.account_period_from.month}} to {{$foreignCompanyDetails.accounts.account_period_to.day}}
                            {{$foreignCompanyDetails.accounts.account_period_to.month}}<br>within {{$foreignCompanyDetails.accounts.must_file_within.months}}
                            months under parent law</p>
                    {{end}}

                    {{if $keyFilingDates.last_accounts_made_up_to}}
                        Last accounts made up to: {{$keyFilingDates.last_accounts_made_up_to}}
                    {{end}}

                {{end}}
            {{end}}

            {{if eq $foreignCompanyDetails.accounting_requirements.foreign_account_type "accounting-requirements-of-originating-country-do-not-apply"}}
                {{ if eq $foreignCompanyDetails.accounting_requirements.terms_of_account_publication "accounting-reference-date-allocated-by-companies-house"}}

                    {{if or $keyFilingDates.next_made_up_to $keyFilingDates.last_accounts_made_up_to}}
                        <h3 class="heading-small">Accounts</h3>
                    {{end}}

                    {{if $keyFilingDates.next_made_up_to}}
                        Next accounts made up to: {{$keyFilingDates.next_made_up_to}}
                    {{end}}
                         <br>
                    {{if $keyFilingDates.last_accounts_made_up_to}}
                        Last accounts made up to: {{$keyFilingDates.last_accounts_made_up_to}}
                    {{end}}
                {{end}}
            {{end}}
        {{end}}
    {{end}}

    {{if not $foreignCompanyDetails }}

        {{if or ($keyFilingDates.last_accounts_made_up_to) ($keyFilingDates.next_accounts_due) ($keyFilingDates.accounting_reference_date.day) }}
            <h3 class="heading-small">Key filing dates</h3>
            <ul class="list list-bullet">
                {{if $keyFilingDates.accounting_reference_date.day}}
                    <li>Accounting reference date: {{$keyFilingDates.accounting_reference_date.day}} {{$keyFilingDates.accounting_reference_date.month}} </li>
                {{end}}
                {{if $keyFilingDates.last_accounts_made_up_to}}
                    <li>Last accounts made up to: {{$keyFilingDates.last_accounts_made_up_to}}</li>
                {{end}}
                {{if $keyFilingDates.next_accounts_due}}
                    <li>Next accounts due: {{$keyFilingDates.next_accounts_due}}</li>
                {{end}}
                {{if $keyFilingDates.last_confirmation_statement}}
                    <li>Last confirmation statement date: {{$keyFilingDates.last_confirmation_statement}}</li>
                {{end}}
                {{if $keyFilingDates.next_confirmation_statement}}
                    <li>Next confirmation statement due: {{$keyFilingDates.next_confirmation_statement}}</li>
                {{end}}
                {{if $keyFilingDates.last_members_list}}
                    <li>Last members list: {{$keyFilingDates.last_members_list}}</li>
                {{end}}
            </ul>
        {{end}}
    {{end}}

    {{if $companyRegistrationInformation.nature_of_business}}
    <h3 class="heading-small">Nature of business (SIC)</h3>
    <ul class="list list-bullet">
        {{range $companyRegistrationInformation.nature_of_business}}
        <li>{{.sic_codes}} {{.sic_codes_description}}</li>
        {{end}}
    </ul>
    {{end}}

    {{if $previousNames}}
    <h3 class="heading-small">Previous company names</h3>
    <table>
        <caption class="visually-hidden">Previous company names</caption>
        <!-- this hidden caption is needed for screen-readers-->
        <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Period</th>
        </tr>
        </thead>
        <tbody>
        {{- range $previousNames -}}
        <tr>
            <td>{{.previous_name}}</td>
            <td scope="row">{{.date_of_change}}</td>
        </tr>
        {{end}}
        </tbody>
    </table>
    {{end}}

    {{if $foreignCompanyDetails}}
    <h3 class="heading-small">Company details in the country of incorporation</h3>
    <table class="foreign-company-details-table">
        <thead>
        <tr>
            <th scope="col">Incorporated in</th>
            <th scope="col">Registration number</th>
            <th scope="col">Legal form</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            {{if $foreignCompanyDetails.country}}
            <td>{{$foreignCompanyDetails.country}}</td>
            {{end}}
            {{if $foreignCompanyDetails.registration_number}}
            <td>{{$foreignCompanyDetails.registration_number}}</td>
            {{end}}
            {{if $foreignCompanyDetails.legal_form}}
            <td>{{$foreignCompanyDetails.legal_form}}</td>
            {{end}}
        </tr>
        </tbody>
    </table>
    <ul class="list list-bullet">
        {{if $foreignCompanyDetails.name}}
        <li>Parent registry: {{$foreignCompanyDetails.name}}</li>
        {{end}}
        {{if $foreignCompanyDetails.governed_by}}
        <li>Governing Law: {{$foreignCompanyDetails.governed_by}}</li>
        {{end}}
        {{if $foreignCompanyDetails.business_activity}}
        <li>Objects of the company: {{$foreignCompanyDetails.business_activity}}</li>
        {{end}}
    </ul>
    {{end}}


    <h2 class="heading-large">People</h2>

    <h2 class="heading-medium">Officers:<br>
        {{if $officers.total_results}} {{$officers.total_results}} officers {{else}} 0 officers {{end}} /
        {{if $officers.resigned_count}} {{$officers.resigned_count}} resignations {{else}} 0 resignations {{end}}
    </h2>
    {{if $officers}}
        {{range $officers.current_officers}}
            <ul class="list list-bullet">

                <li>{{.officer_role}} {{.name}}

                    {{ if .resigned_on }}
                        <span id="officer-status-tag-resigned" class="status-tag ceased-tag">Resigned</span>
                        {{else}}
                        <span id="officer-status-tag-active" class="status-tag">Active</span>
                        {{end}}
                    </li>

                    {{if .nationality}}
                        <li>Nationality: {{.nationality}}</li>
                    {{end}}

                    {{if .appointed_on}}
                        <li>Appointed: {{.appointed_on}}</li>
                    {{end}}

                    {{if .date_of_birth}}
                        <li>Date of birth: {{index .date_of_birth "month"}} {{index .date_of_birth "year"}} </li>
                    {{end}}

                    {{if .resigned_on}}
                        <li>Resigned: {{.resigned_on}}</li>
                    {{end}}

                    {{if .address}}
                        <li>Correspondence address:
                            {{if .address.care_of}}
                                {{index .address "care_of"}},
                            {{end}}

                            {{if .address.po_box}}
                                {{index .address "po_box"}},
                            {{end}}

                            {{if .address.premises}}
                                {{index .address "premises"}},
                            {{end}}

                            {{if .address.address_line_1}}
                                {{index .address "address_line_1"}},
                            {{end}}

                            {{if .address.address_line_2}}
                                {{index .address "address_line_2"}},
                            {{end}}

                            {{if .address.locality}}
                                {{index .address "locality"}},
                            {{end}}

                            {{if .address.region}}
                                {{index .address "region"}},
                            {{end}}

                            {{if .address.country}}
                                {{index .address "country"}},
                            {{end}}

                            {{if .address.postal_code}}
                                {{index .address "postal_code"}}
                            {{end}}

                        </li>
                    {{end}}

                    {{if .country_of_residence}}
                         <li>Country/State of Residence: {{.country_of_residence}}</li>
                    {{end}}

                    {{if .occupation}}
                        <li>Occupation: {{.occupation}}</li>
                    {{end}}

                    {{if .identification}}

                        {{if .identification.identification_type}}
                        <li>{{.identification.identification_type}}</li>
                        {{end}}

                        {{if .identification.place_registration}}
                        <li>Place of registration: {{.identification.place_registration}}</li>
                        {{end}}

                        {{if .identification.place_registered}}
                        <li>Place registered: {{.identification.place_registered}}</li>
                        {{end}}

                        {{if .identification.registration_number}}
                        <li>Registration number: {{.identification.registration_number}}</li>
                        {{end}}

                        {{if .identification.legal_authority}}
                        <li>Legal authority: {{.identification.legal_authority}}</li>
                        {{end}}

                        {{if .identification.legal_form}}
                        <li>Legal form: {{.identification.legal_form}}</li>
                        {{end}}

                    {{end}}

                 </ul>
            <hr>
        {{end}}
    {{else}}
        <p>There are no officer details available for this company.</p>
    {{end}}

    <!--PSC & STATMENTS-->

    <h2 class="heading-medium">Persons with significant control:<br>
        {{if $pscs.active_count}} {{$pscs.active_count}} active person with significant control {{else}} 0 active person with significant control {{end}} /
        {{if $pscStatements.active_count}} {{$pscStatements.active_count}} active statements {{else}} 0 active statements {{end}}
    </h2>

    {{if or $pscs $pscStatements}}
        {{if $pscs}}
            {{range $pscs.items}}
                <ul class="list list-bullet">

                    <li>{{.name}}

                        {{ if .ceased_on }}
                        <span id="officer-status-tag-resigned" class="status-tag ceased-tag">Ceased</span>
                        {{else}}
                        <span id="officer-status-tag-active" class="status-tag">Active</span>
                        {{end}}
                    </li>

                    {{if .address}}
                    <li>Correspondence address:

                        {{if .address.care_of}}
                        {{index .address "care_of"}},
                        {{end}}

                        {{if .address.po_box}}
                        {{index .address "po_box"}},
                        {{end}}

                        {{if .address.premises}}
                        {{index .address "premises"}},
                        {{end}}

                        {{if .address.address_line_1}}
                        {{index .address "address_line_1"}},
                        {{end}}

                        {{if .address.address_line_2}}
                        {{index .address "address_line_2"}},
                        {{end}}

                        {{if .address.locality}}
                        {{index .address "locality"}},
                        {{end}}

                        {{if .address.region}}
                        {{index .address "region"}},
                        {{end}}

                        {{if .address.country}}
                        {{index .address "country"}},
                        {{end}}

                        {{if .address.postal_code}}
                        {{index .address "postal_code"}}
                        {{end}}

                    </li>
                    {{end}}

                    {{if .notified_on}}
                    <li> Notified on: {{.notified_on}} </li>
                    {{end}}

                    {{if .ceased_on}}
                    <li>Ceased on: {{.ceased_on}} </li>
                    {{end}}

                    {{if .date_of_birth}}
                    <li>Date of birth: {{index .date_of_birth "month"}} {{index .date_of_birth "year"}} </li>
                    {{end}}

                    {{if .nationality}}
                    <li>Nationality: {{.nationality}}</li>
                    {{end}}

                    {{if .country_of_residence}}
                    <li>Country of residence: {{.country_of_residence}}</li>
                    {{end}}

                    {{if .identification}}

                        {{if .identification.legal_authority}}
                        <li>Governing law: {{.identification.legal_authority}}</li>
                        {{end}}

                        {{if .identification.legal_form}}
                        <li>Legal form: {{.identification.legal_form}}</li>
                        {{end}}

                        {{if .identification.place_registered}}
                        <li>Place registered: {{.identification.place_registered}}</li>
                        {{end}}

                        {{if .identification.registration_number}}
                        <li>Registration number: {{.identification.registration_number}}</li>
                        {{end}}

                        {{if .identification.country_registered}}
                        <li>Incorporated in: {{.identification.country_registered}}</li>
                        {{end}}

                    {{end}}
                </ul>

                {{if .natures_of_control}}
                <h3 class="heading-small">Nature of control:</h3>

                <ul class="list list-bullet">
                    {{range .natures_of_control}}
                    <li> {{.natures_of_control_descriptions}}</li>
                    {{end}}
                </ul>

                </li>
                <hr>
                {{end}}
            {{end}}
        {{end}}

        {{if $pscStatements}}
            <h3 class="heading-medium">Statements</h3>
            {{range $pscStatements.items}}
                <h3 class="heading-small">Statement

                    {{if .ceased_on}}
                    <span id="statements-status-tag-withdrawn" class="status-tag ceased-tag">Withdrawn</span>
                    {{else}}
                    <span id="statements-status-tag-active" class="status-tag">Active</span>
                    {{end}}
                </h3>

                {{if .statement}}
                    <p>{{.statement}}</p>
                {{end}}

                <ul class="list list-bullet">

                    {{if .notified_on}}
                        <li>Notified on: {{.notified_on}}</li>
                    {{end}}

                    {{if .ceased_on}}
                        <li>Withdrawn on: {{.ceased_on}}</li>
                    {{end}}
                </ul>
            {{end}}
        {{end}}
    {{else}}
    <p>There are no persons with significant control or statements available for this company.</p>
    {{end}}

    {{if $recentFilingHistory}}
        <h3 class="heading-large">Recent Filing History</h3>
        <table>
            <caption class="visually-hidden">Recent Filing History</caption>
            <!-- this hidden caption is needed for screen-readers-->
            <thead>
            <tr>
                <th scope="col">Date</th>
                <th scope="col">Form</th>
                <th scope="col">Description</th>
            </tr>
            </thead>
            <tbody>
            {{- range $recentFilingHistory -}}
            <tr>
                <td nowrap="nowrap">{{.date}}</td>
                <td scope="row">{{.form}}</td>
                <td>{{.description}}</td>
            </tr>
            {{end}}
            </tbody>
        </table>
    {{end}}

    {{if $ukEstablishment}}
    <h3 class="heading-small">UK establishments</h3>
    <table>
        <caption class="visually-hidden">UK establishments</caption>
        <!-- this hidden caption is needed for screen-readers-->
        <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col">Number</th>
            <th scope="col">Town</th>
            <th scope="col">Status</th>
        </tr>
        </thead>
        <tbody>
        {{- range $ukEstablishment -}}
        <tr>
            <td>{{.company_name}}</td>
            <td scope="row">{{.company_number}}</td>
            <td scope="row">{{.locality}}</td>
            <td scope="row">{{.company_status}}</td>
        </tr>
        {{end}}
        </tbody>
    </table>
    {{end}}

</main>
</body>
</html>